<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="icon" href="/assets/app-icons/finder/32.png">
    <meta name="description" content="MacOS Desktop experience for Web">
    <title>macOS in Preact</title>

    <meta property="og:title" content="macOS in Preact">
    <meta property="og:description" content="A painting of macOS Big Sur in HTML, CSS and JS">
    <meta property="og:image" content="https://macos.now.sh/assets/cover-image.png">
    <meta property="og:url" content="https://macos.now.sh">
    <meta name="twitter:card" content="summary_large_image">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <script type="module" crossorigin src="/assets/index.de5a9c43.js"></script>
    <link rel="modulepreload" href="/assets/vendor.b8623d82.js">
    <link rel="stylesheet" href="/assets/index.421d811c.css">
</head>
<body class="light">
    <div id="root">
        <main class="_main_16bmc_1">
            <!-- … all your existing menu / dock markup … -->
            <header id="top-bar" class="_header_1olvu_1">…</header>
            <section class="_container_1yngt_1"></section>
            <section id="dock" class="_container_1f0zn_1">…</section>
        </main>

        <!-- ==== SPLASH SCREEN (the element you asked about) ==== -->
        <div class="_splashScreen_11rgz_1">
            <svg fill="white" xmlns="http://www.w3.org/2000/svg"
                 width="100" height="100" viewBox="0 0 24 24">
                <path d="M18.71,19.5C17.88,20.74 17,21.95 15.66,21.97C14.32,22 13.89,21.18 12.37,21.18C10.84,21.18 10.37,21.95 9.1,22C7.79,22.05 6.8,20.68 5.96,19.47C4.25,17 2.94,12.45 4.7,9.39C5.57,7.87 7.13,6.91 8.82,6.88C10.1,6.86 11.32,7.75 12.11,7.75C12.89,7.75 14.37,6.68 15.92,6.84C16.57,6.87 18.39,7.1 19.56,8.82C19.47,8.88 17.39,10.1 17.41,12.63C17.44,15.65 20.06,16.66 20.09,16.67C20.06,16.74 19.67,18.11 18.71,19.5M13,3.5C13.73,2.67 14.94,2.04 15.94,2C16.07,3.17 15.6,4.35 14.9,5.19C14.21,6.04 13.07,6.7 11.95,6.61C11.8,5.46 12.36,4.26 13,3.5Z"></path>
            </svg>
        </div>

        <!-- ==== STARTUP SOUND ==== -->
        <audio id="mac-startup" src="/assets/sounds/mac-startup-sound.mp3" preload="auto"></audio>

        <!-- ==== ORIGINAL CLICK-BACKUP (unchanged) ==== -->
        <script>
          (function () {
            const audio = document.getElementById('mac-startup');
            if (!audio) return;

            function playStartupSound() {
              audio.currentTime = 0;
              const p = audio.play();
              if (p !== undefined) {
                p.catch(() => {
                  const tryPlay = () => {
                    audio.play().catch(() => {});
                    document.body.removeEventListener('click', tryPlay);
                    document.body.removeEventListener('touchstart', tryPlay);
                  };
                  document.body.addEventListener('click', tryPlay, { once: true });
                  document.body.addEventListener('touchstart', tryPlay, { once: true });
                });
              }
            }

            if (document.readyState === 'loading') {
              document.addEventListener('DOMContentLoaded', playStartupSound);
            } else {
              playStartupSound();
            }

            window.addEventListener('pageshow', e => {
              if (e.persisted || !e.persisted) playStartupSound();
            });
          })();
        </script>

        <!-- ==== NEW: PLAY WHEN SPLASH DISAPPEARS (after first interaction) ==== -->
        <script>
          (function () {
            const audio = document.getElementById('mac-startup');
            const splash = document.querySelector('._splashScreen_11rgz_1');

            if (!audio || !splash) return;

            // Helper – play once
            const playOnce = () => {
              audio.currentTime = 0;
              audio.play().catch(() => {});
            };

            // First user gesture unlocks autoplay
            document.addEventListener('click', function unlock() {
              document.removeEventListener('click', unlock);

              // If splash is already gone, play immediately
              if (splash.classList.contains('_hidden_11rgz_15') ||
                  splash.offsetParent === null) {
                playOnce();
                return;
              }

              // Observe class changes (the app adds _hidden_11rgz_15) or visibility
              const obs = new MutationObserver(() => {
                if (splash.classList.contains('_hidden_11rgz_15') ||
                    splash.offsetParent === null) {
                  obs.disconnect();
                  playOnce();
                }
              });

              obs.observe(splash, {
                attributes: true,
                attributeFilter: ['class', 'style']
              });

              // Fallback: if observer somehow misses it, play after a short delay
              setTimeout(() => {
                if (splash.classList.contains('_hidden_11rgz_15') ||
                    splash.offsetParent === null) {
                  obs.disconnect();
                  playOnce();
                }
              }, 3000);
            }, { once: true });
          })();
        </script>

        <div class="_backgroundCover_16bmc_8" aria-hidden="true"></div>
    </div>

    <noscript>You need to enable JavaScript to run this app.</noscript>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;350;400;500;600;700&display=swap"
          rel="stylesheet">
</body>
</html>